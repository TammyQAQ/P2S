# P2S Project Cursor Rules

## File Organization

### Figures and Plots
- **ALWAYS** save output PNG files to the `figures/` directory
- **ALWAYS** place plotting scripts in the `plots/` directory
- When creating visualizations, use `os.makedirs('figures', exist_ok=True)` before saving
- Save plots with descriptive filenames (e.g., `inclusion_time_violin.png`, `mev_attack_distribution.png`)
- Use high DPI (300) for publication-quality figures: `plt.savefig('figures/filename.png', dpi=300, bbox_inches='tight')`

### File Updates vs. New Files
- **PREFER updating existing files** over creating new ones
- Before creating a new file, check if a similar file already exists in the project
- When adding functionality:
  - If a file exists for similar functionality, extend that file
  - Only create new files when the functionality is genuinely distinct
  - Consolidate related functionality into existing files when possible
- For plotting scripts: update existing files in `plots/` directory rather than creating duplicates
- For analysis scripts: update existing files in `scripts/analysis/` rather than creating new ones

### Parameter Extraction
- **ALWAYS** extract parameters from on-chain data when available
- Do not hardcode parameters that can be derived from blockchain state
- When parameters are needed:
  1. First attempt to extract from on-chain data (blockchain state, contract calls, etc.)
  2. If on-chain data is not available, use test data from `data/` directory
  3. Only use hardcoded values as fallback or for testing purposes
- Parameters should be loaded dynamically from:
  - Blockchain RPC endpoints
  - On-chain contract state
  - Recent block data
  - Network configuration from chain state

## Code Style

### Python Scripts
- Use `#!/usr/bin/env python3` shebang for executable scripts
- Include docstrings for all modules and functions
- Use type hints where appropriate
- Follow PEP 8 style guidelines

### Go Code
- Follow standard Go formatting (`gofmt`)
- Use meaningful variable and function names
- Include comments for exported functions and types

## Data Handling
- Load test data from `data/` directory using the latest available files
- Use JSON format for data storage
- Include timestamps in data filenames when creating new test data

## Testing
- Place test files in `tests/` directory
- Use descriptive test names that indicate what is being tested
- Include both unit tests and integration tests where appropriate

## Documentation
- Update relevant documentation in `docs/` when making significant changes
- Keep README.md up to date with project structure and usage

